# Continuous_Intergration
Repo related to studies in continuous integration. Main goal is to develop abilities in Jenkins and Docker tools.

### First Goal
Set the Jenkins environment with the Docker tool trough a Dockerfile. 
Dockerfile documents must start with FROM, command which specifies the parent image from which we are building. It is possible to have more than one FROM in one Dockerfile to create multiple images or use one build stage as a dependency for another one.
Based on Jenkins GitHub guide use it is possible to intall more tools. This is made running container as root via apt-get. It says as well that it is good practice to drop back to the regular jenkins user.

### Building Dockerfiles 
The Dockerfile are translated into images with the build command: docker build -t image_name:image_version Dockerfile_Path.

### Plugins 
Rely on the plugin manager CLI to set the plugins. Possible to install custom plugins with the Docker command: COPY --chown=jenkins:jenkins path/to/custom/hpi /usr/share/jenkins/ref/plugins/. Where the custom.hpi is the file contaning the plugin.

### Volumes 
It is possible to set a volume in the Dockerfile. This statement declares that a specific path of the container must be mounted to a Docker volume. When you run the container, Docker will create an anonymous volume (volume with a unique id as the name) and mount it to the specified path. Appenrently the best way to create a volume is indeed, directly, trougth the command line.
The Jenkins usage guide suggests to make a persistent volume with the command: -v jenkins_home:/var/jenkins_home. What creates a docker volume on the host machine retaining the content even when the container is stopped, started or deleted. 

### Jenkins Configuration  
- #### Definitions
  - Job: A user-configured description of the work that Jenkins will manage
  - Build: When Jenkins run through the instructions in a job
  - Build Step: Task that Jenkins will run
  - Build Trigger: Event that starts a build (Manual or Automate)
- #### Job Configuration:
  - Description: Describes the job and what it does.
  - Discard Old Builds: Manage the old builds by only keeping builds by a maximum amount of time or a maximum number of builds. 
  - Build Environment: give control over the space the job will run and the steps to take.
  - Build: Where to inform a specific requisition. 
  - Post-build Actions: additional steps to take before the entire build wraps up (archive something, send an email, …). 
  - Source Code Management: Control the way Jenkins interact with any code you have stored in a Git repository
- #### Different Types of Jobs
  - Free Style Job: Let you freely control the way Jenkins Manages the taks you want to automate.
  - Pipeline: Useful for more complex jobs. Can run build steps in parallel. And even use different computer platforms to run steps.
  - Multi-configuration Project: Useful when you might have multiple jobs that do the same thing but for a different combinations of parameters. Instead of creating many job for each set of parameters, you can use the multi-configuration project to create one job that apply the parameters for you.
  - GitHub Organization and Multibranch Pipeline: Are specially suited for working with code repositories. 
    - GitHub Organization: Are configured to scan GitHub repositories for files that Jenkins uses to configures jobs automatically.
    - Multibranch Pipeline: Can be used to configure jobs for different branches belonging to the same repo.
  - Folder is not really a job. Jenkins uses folders to group things together.
- #### Build Triggers 
  - How Jobs can be started:
    - Trigger build remotely: process outside Jenkins starts jobs via URL. 
    - Build after other projects are built: Jenkins start jobs immediately after other jobs are finished.
    - Build Periodically: Jobs that need to be run hourly, daily, … 
    - GitHub hook trigger for GITScm polling: Projects that are tied to GitHub. Allows Jenkins to start jobs based on activity on GitHub like releases, tags or other types of commits. 
    - Poll SCM: Start a job based on activity in a repo. Not as efficient as trigger from a GitHub hook.  
- #### Build Environment
  - Delete workspaces before build starts: Jenkins remove the workspace, place where the files generated by previous jobs are storage, and recreate for each new run.
  - Use secret texts or files: useful for injecting secrets into your job in runtime. 
  - Abort the build if it is stuck: useful to keep jobs from running on and on if something keeps the job from starting normally.
  - Add timestamps to the console output: gives more detail on when a certain item was written to the log.
- #### Build Steps 
  - Invoke top-level Maven targets: opens a dialog where we can select our maven version and enter the goals for our build
    - Java command that will run the code at Maven's build: java -cp target/hello-1.0-SNAPSHOT.jar com.learningjenkins.App
- #### Artifacts
  - Jenkins generate products at the end of each build, the artifacts. 
  - How to look at a Artifact of a Job:
    - At the end of the job's command line, in a line where it is written "Building jar".
    - It is possible to manage artifacts with a Post-build step.
      - Post-build Action
        - Archive the Artifacts: specify the exact files we want to have archived for each successful build.
          - **/hello-1.0-SNAPSHOT.jar
- #### Scheduling Jobs
  - Jenkins Scheduler Format
    - *(Minute, 0-59)
    -  *(Hour, 0-23)
    -   *(Day of the Month)
    -    *(Month)
    -     *(Day of the week)
      - * -> All
      - H -> Spread out jobs around the desired time. That way if there are multiple jobs scheduled for the exact same time, Jenkins can spread them out.
      - @hourly
      - @daily
      - @midnight
      - @weekly
      - @monthly
- #### Views and Folders
  - Views provide a way to associate jobs on a dashboard and display them together. Filter.
  - Folders allow you to create structures that are very similar to file systems on a disc. Each folder can contain jobs, views and other folders.
- #### Pipelines
  - Stored in a file named Jenkinsfile. Can be versioned in a code repository. Configure Jenkins Jobs. Contain Stages and Steps
  - Pipeline Stages are sections of the pipeline. These stages describe and manage the flow of the code through the pipeline.
  - Steps are configured inside a Stage. Each Stage must have at least one Step. Steps are the actions taken at each Stage.

### Result
Had a lot of problems in setting the port to be exposed and the volume in the Dockerfile. Best way was to set the environment with the especifications of the Dockerfile just relying on the main Jenkins image and the Docker command: docker run -d -p 8080:8080 -v jenkins_home:/var/jenkins_home --name jenkins image_built:image_tag.

## Second Goal 
Set a docker compose enviroment.
